import{j as e,r as l}from"./ui-vendor-BBvy5_e4.js";import{C as r,a as c,b as m,d as a}from"./card-wt_nJGez.js";import{w as v,M as o,B as x,T as h}from"./index-JZK0iDKY.js";import{B as s}from"./badge-DkYv5gj6.js";import{S as j}from"./sparkles-DHUIuF-p.js";import{C as u}from"./circle-check-2r_On2bL.js";import{C as y}from"./circle-x-isR9nabO.js";import{I as w}from"./info-C41hep1V.js";import"./charts-BvZVcBDs.js";function A({className:i,...t}){return e.jsx("textarea",{"data-slot":"textarea",className:v("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",i),...t})}const p=`{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "s3:GetObject",
        "s3:PutObject"
      ],
      "Resource": "arn:aws:s3:::my-bucket/*"
    },
    {
      "Effect": "Allow",
      "Action": "s3:*",
      "Resource": "*"
    }
  ]
}`;function O(){const[i,t]=l.useState(p),[n,d]=l.useState(!1),[f,N]=l.useState(!1),g=()=>{d(!0),setTimeout(()=>{d(!1),N(!0)},1500)};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"IAM Policy Explainer"}),e.jsx("p",{className:"text-muted-foreground",children:"Paste your IAM policy JSON to get a plain English explanation and security analysis"})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs(r,{className:"border-border",children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(o,{className:"w-5 h-5 text-primary"}),"IAM Policy JSON"]}),e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>t(p),children:"Load Example"})]})}),e.jsxs(a,{children:[e.jsx(A,{value:i,onChange:b=>t(b.target.value),className:"font-mono text-sm h-[500px] bg-muted/30 resize-none",placeholder:"Paste your IAM policy JSON here..."}),e.jsx("div",{className:"mt-4",children:e.jsx(x,{className:"w-full",onClick:g,disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 border-2 border-current border-t-transparent rounded-full animate-spin"}),"Analyzing Policy..."]}):e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),"Analyze Policy"]})})})]})]}),e.jsxs(r,{className:"border-border",children:[e.jsx(c,{children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5 text-primary"}),"Analysis Results"]})}),e.jsx(a,{children:f?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-muted/30 border border-border",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Policy Summary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This policy contains 2 statements that grant permissions for S3 operations."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Statements Breakdown"}),e.jsxs("div",{className:"p-4 rounded-lg border border-green-500/50 bg-green-500/5",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx(u,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold",children:"Statement #1"}),e.jsx(s,{variant:"outline",className:"text-xs",children:"Least Privilege"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:'Allows reading and writing objects in the specific bucket "my-bucket".'})]})]}),e.jsxs("div",{className:"ml-8 space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Effect:"}),e.jsx("span",{className:"ml-2 text-muted-foreground",children:"Allow"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Actions:"}),e.jsxs("div",{className:"ml-2 mt-1 space-y-1",children:[e.jsx(s,{variant:"secondary",className:"text-xs mr-1",children:"s3:GetObject"}),e.jsx(s,{variant:"secondary",className:"text-xs",children:"s3:PutObject"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Resource:"}),e.jsx("code",{className:"ml-2 text-xs text-muted-foreground bg-muted px-2 py-1 rounded",children:"arn:aws:s3:::my-bucket/*"})]})]})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-red-500/50 bg-red-500/5",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx(y,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold",children:"Statement #2"}),e.jsx(s,{variant:"destructive",className:"text-xs",children:"Critical Issue"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Grants all S3 permissions on all resources. This is overly broad and violates the principle of least privilege."})]})]}),e.jsxs("div",{className:"ml-8 space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Effect:"}),e.jsx("span",{className:"ml-2 text-muted-foreground",children:"Allow"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Actions:"}),e.jsx(s,{variant:"destructive",className:"text-xs ml-2",children:"s3:* (All S3 actions)"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Resource:"}),e.jsx(s,{variant:"destructive",className:"text-xs ml-2",children:"* (All resources)"})]})]})]})]}),e.jsx("div",{className:"p-4 rounded-lg bg-warning/10 border border-warning/50",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(h,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2 text-warning",children:"Security Recommendations"}),e.jsxs("ul",{className:"text-sm space-y-2 text-muted-foreground",children:[e.jsx("li",{children:"• Remove Statement #2 or restrict it to specific resources"}),e.jsx("li",{children:"• Use wildcard (*) permissions only when absolutely necessary"}),e.jsx("li",{children:"• Consider using condition statements to further restrict access"}),e.jsx("li",{children:"• Implement separate policies for different use cases"})]})]})]})}),e.jsxs("div",{className:"p-4 rounded-lg bg-card border border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold",children:"Security Risk Score"}),e.jsx("span",{className:"text-2xl font-bold text-red-500",children:"8/10"})]}),e.jsx("div",{className:"w-full h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-500",style:{width:"80%"}})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"High risk due to overly permissive wildcard statement"})]})]}):e.jsx("div",{className:"h-[500px] flex items-center justify-center text-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(o,{className:"w-8 h-8 text-primary"})}),e.jsx("div",{children:e.jsx("p",{className:"text-muted-foreground",children:'Paste an IAM policy and click "Analyze Policy" to see the explanation'})})]})})})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsx(r,{className:"border-border",children:e.jsx(a,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-lg bg-green-500/10 flex-shrink-0",children:e.jsx(u,{className:"w-5 h-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-1",children:"Least Privilege"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Only grant the minimum permissions needed for the task"})]})]})})}),e.jsx(r,{className:"border-border",children:e.jsx(a,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-lg bg-amber-500/10 flex-shrink-0",children:e.jsx(h,{className:"w-5 h-5 text-amber-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-1",children:"Avoid Wildcards"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Wildcard (*) permissions can expose your resources to risk"})]})]})})}),e.jsx(r,{className:"border-border",children:e.jsx(a,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-lg bg-blue-500/10 flex-shrink-0",children:e.jsx(w,{className:"w-5 h-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-1",children:"Use Conditions"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Add condition statements for IP ranges, MFA, and time-based access"})]})]})})})]})]})}export{O as IAMExplainerPage};
