import{r as u,j as e}from"./ui-vendor-BBvy5_e4.js";import{C as l,d as n,a as h,b as g,c as I}from"./card-wt_nJGez.js";import{c as d,B as a,R,H as E,S as T}from"./index-JZK0iDKY.js";import{B as o}from"./badge-DkYv5gj6.js";import{P as p}from"./progress-CqExqoQx.js";import{T as k,a as M,b as v,c as j}from"./tabs-D7enaHaU.js";import{S as _}from"./shield-check-psDAXoSw.js";import{E as F}from"./eye-C6E-EgF6.js";import{N as $,H as P}from"./network-DOCAH2rh.js";import{K as B}from"./key-CgWt1gFH.js";import{I as D}from"./info-C41hep1V.js";import{E as L}from"./external-link-DDWfovnJ.js";import"./charts-BvZVcBDs.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],z=d("chevron-right",O);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],U=d("circle-alert",H);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],V=d("lock",G),t=[{id:"sec-1",title:"S3 Buckets with Public Access",description:"2 S3 buckets have public access enabled, potentially exposing sensitive data.",severity:"critical",category:"Data Exposure",affectedResources:2,status:"open",recommendation:"Review and disable public access for buckets containing sensitive data."},{id:"sec-2",title:"IAM Users without MFA",description:"5 IAM users do not have multi-factor authentication enabled.",severity:"high",category:"Identity & Access",affectedResources:5,status:"open",recommendation:"Enable MFA for all IAM users with console access."},{id:"sec-3",title:"Security Groups with 0.0.0.0/0",description:"3 security groups allow inbound traffic from any IP address.",severity:"high",category:"Network Security",affectedResources:3,status:"in_progress",recommendation:"Restrict security group rules to specific IP ranges."},{id:"sec-4",title:"Unencrypted EBS Volumes",description:"8 EBS volumes do not have encryption enabled at rest.",severity:"medium",category:"Encryption",affectedResources:8,status:"open",recommendation:"Enable default EBS encryption and create encrypted copies."},{id:"sec-5",title:"Root Account Activity Detected",description:"Root account was used for API calls in the last 30 days.",severity:"medium",category:"Identity & Access",affectedResources:1,status:"open",recommendation:"Use IAM users instead of root account for daily operations."},{id:"sec-6",title:"CloudTrail Not Enabled",description:"CloudTrail logging is not enabled in 2 regions.",severity:"medium",category:"Logging & Monitoring",affectedResources:2,status:"resolved",recommendation:"Enable CloudTrail in all regions for complete audit trail."},{id:"sec-7",title:"Unused IAM Access Keys",description:"4 IAM access keys have not been used in over 90 days.",severity:"low",category:"Identity & Access",affectedResources:4,status:"open",recommendation:"Rotate or delete unused access keys."}],f=[{name:"CIS AWS Foundations",passed:42,total:55,percentage:76},{name:"AWS Well-Architected",passed:38,total:50,percentage:76},{name:"SOC 2 Controls",passed:28,total:35,percentage:80},{name:"PCI DSS",passed:22,total:30,percentage:73}],K={"Data Exposure":P,"Identity & Access":B,"Network Security":$,Encryption:V,"Logging & Monitoring":F},W={critical:{color:"text-red-500",bg:"bg-red-500/10",border:"border-red-500/30"},high:{color:"text-orange-500",bg:"bg-orange-500/10",border:"border-orange-500/30"},medium:{color:"text-amber-500",bg:"bg-amber-500/10",border:"border-amber-500/30"},low:{color:"text-blue-500",bg:"bg-blue-500/10",border:"border-blue-500/30"}},Y={open:{label:"Open",color:"bg-red-500"},in_progress:{label:"In Progress",color:"bg-amber-500"},resolved:{label:"Resolved",color:"bg-green-500"}};function ne(){const[b,y]=u.useState("findings"),[c,m]=u.useState(null),N=t.filter(s=>s.status==="open"),r=t.filter(s=>s.severity==="critical"&&s.status!=="resolved").length,w=t.filter(s=>s.severity==="high"&&s.status!=="resolved").length,C=c?t.filter(s=>s.severity===c):t,S=Math.round(t.filter(s=>s.status==="resolved").length/t.length*100);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Security Audit"}),e.jsx("p",{className:"text-muted-foreground",children:"Review security findings and compliance status"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(a,{variant:"outline",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Run Scan"]}),e.jsxs(a,{variant:"outline",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Export Report"]})]})]}),e.jsx(l,{className:`${r>0?"border-red-500/30 bg-red-500/5":"border-green-500/30 bg-green-500/5"}`,children:e.jsx(n,{className:"py-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-4 rounded-2xl ${r>0?"bg-red-500/10":"bg-green-500/10"}`,children:r>0?e.jsx(U,{className:"w-12 h-12 text-red-500"}):e.jsx(_,{className:"w-12 h-12 text-green-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Security Score"}),e.jsxs("div",{className:`text-4xl font-bold ${r>0?"text-red-500":"text-green-500"}`,children:[S,"/100"]})]})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-background",children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:r}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Critical"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-background",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:w}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"High"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-background",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-500",children:t.filter(s=>s.severity==="medium"&&s.status!=="resolved").length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Medium"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-background",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-500",children:t.filter(s=>s.severity==="low"&&s.status!=="resolved").length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Low"})]})]})]})})}),e.jsxs(k,{value:b,onValueChange:y,children:[e.jsxs(M,{children:[e.jsxs(v,{value:"findings",children:["Security Findings",e.jsx(o,{variant:"secondary",className:"ml-2",children:N.length})]}),e.jsx(v,{value:"compliance",children:"Compliance"})]}),e.jsxs(j,{value:"findings",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{variant:c===null?"secondary":"ghost",size:"sm",onClick:()=>m(null),children:"All"}),["critical","high","medium","low"].map(s=>e.jsx(a,{variant:c===s?"secondary":"ghost",size:"sm",onClick:()=>m(s),className:"capitalize",children:s},s))]}),e.jsx("div",{className:"space-y-4",children:C.map(s=>{const i=W[s.severity],x=Y[s.status],A=K[s.category]||T;return e.jsx(l,{className:`${i.border} hover:border-primary/50 transition-colors cursor-pointer`,children:e.jsxs(n,{className:"py-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${i.bg}`,children:e.jsx(A,{className:`w-5 h-5 ${i.color}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold",children:s.title}),e.jsx(o,{className:`${i.bg} ${i.color} border-0 capitalize`,children:s.severity}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${x.color}`}),e.jsx("span",{className:"text-xs text-muted-foreground",children:x.label})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-3",children:[e.jsx(o,{variant:"outline",className:"text-xs",children:s.category}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.affectedResources," affected resource",s.affectedResources!==1?"s":""]})]})]}),e.jsx(a,{variant:"ghost",size:"icon",children:e.jsx(z,{className:"w-4 h-4"})})]}),s.status!=="resolved"&&e.jsx("div",{className:"mt-4 p-3 rounded-lg bg-muted/50",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-primary mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Recommendation: "}),e.jsx("span",{className:"text-muted-foreground",children:s.recommendation})]})]})})]})},s.id)})})]}),e.jsxs(j,{value:"compliance",className:"space-y-4 mt-4",children:[e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:f.map(s=>e.jsxs(l,{children:[e.jsx(h,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-base",children:s.name}),e.jsxs(o,{variant:s.percentage>=80?"default":s.percentage>=60?"secondary":"destructive",children:[s.percentage,"%"]})]})}),e.jsxs(n,{children:[e.jsx(p,{value:s.percentage,className:"h-2 mb-2"}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{children:[s.passed," passed"]}),e.jsxs("span",{children:[s.total-s.passed," failed"]})]})]})]},s.name))}),e.jsxs(l,{children:[e.jsxs(h,{children:[e.jsx(g,{children:"Compliance Overview"}),e.jsx(I,{children:"Track your compliance status across multiple frameworks"})]}),e.jsx(n,{children:e.jsx("div",{className:"space-y-4",children:f.map(s=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-40 font-medium",children:s.name}),e.jsx("div",{className:"flex-1",children:e.jsx(p,{value:s.percentage,className:"h-3"})}),e.jsxs("div",{className:"w-20 text-right",children:[e.jsx("span",{className:"font-bold",children:s.passed}),e.jsxs("span",{className:"text-muted-foreground",children:["/",s.total]})]}),e.jsxs(a,{variant:"ghost",size:"sm",children:["View",e.jsx(L,{className:"w-3 h-3 ml-1"})]})]},s.name))})})]})]})]})]})}export{ne as SecurityAuditPage};
